# 测试指南

## 🚀 快速开始

### 1. 编译项目

```bash
cd Verdent_account_manger
npm install
npm run tauri dev
```

### 2. 测试账户面板显示

#### 2.1 查看现有账户
1. 打开应用后,切换到 "账户管理" 标签
2. 查看账户卡片是否显示以下新增字段:
   - ✅ 订阅类型 (带颜色标签)
   - ✅ 试用天数
   - ✅ 过期时间 (带剩余天数提示)
   - ✅ 详细额度信息 (剩余/已用/总计)

#### 2.2 测试颜色显示
- **订阅类型颜色**:
  - Free: 灰色 (#6b7280)
  - Starter: 蓝色 (#3b82f6)
  - Pro: 紫色 (#8b5cf6)
  - Max: 橙色 (#f59e0b)

- **过期时间颜色**:
  - 正常 (>3天): 绿色 (#10b981)
  - 即将过期 (≤3天): 橙色 (#f59e0b)
  - 已过期 (<0天): 红色 (#ef4444)

#### 2.3 测试额度显示
- 查看额度进度条是否正确显示
- 查看 "剩余/已用/总计" 是否正确显示
- 查看百分比是否正确计算

### 3. 测试一键登录功能

#### 3.1 正常登录流程
1. 选择一个有有效 Token 的账户
2. 点击 "🚀 一键登录到 VS Code" 按钮
3. 观察按钮状态变为 "⏳ 登录中..."
4. 等待登录完成
5. 应该看到成功提示: "✅ 已发送登录请求到 VS Code!"
6. VS Code 应该自动打开
7. 在 VS Code 中检查 Verdent 插件是否已登录

#### 3.2 测试错误情况

**测试 1: 无 Token 的账户**
1. 选择一个没有 Token 的账户
2. 点击登录按钮
3. 应该看到提示: "该账户没有 Token,无法登录"

**测试 2: 过期账户**
1. 选择一个已过期的账户 (过期时间显示为红色)
2. 点击登录按钮
3. 应该看到确认对话框: "该账户已过期,是否仍要尝试登录?"
4. 点击 "取消" 应该中止登录
5. 点击 "确定" 应该继续尝试登录

**测试 3: 无效 Token**
1. 编辑一个账户,将 Token 改为无效值
2. 点击登录按钮
3. 应该看到错误提示: "❌ 登录失败: 获取授权码失败..."

#### 3.3 测试加载状态
1. 点击登录按钮后,按钮应该变为禁用状态
2. 按钮文字应该变为 "⏳ 登录中..."
3. 登录完成后,按钮应该恢复正常状态

### 4. 测试自动注册功能

#### 4.1 注册新账户
1. 点击 "➕ 自动注册" 按钮
2. 配置注册参数:
   - 数量: 1
   - 密码: VerdentAI@2024
   - 并发数: 1
   - 无头模式: 关闭 (方便观察)
3. 点击 "开始注册"
4. 观察注册流程的实时日志输出
5. 等待注册完成

#### 4.2 验证新账户数据
注册完成后,检查新账户是否包含以下字段:
- ✅ email
- ✅ password
- ✅ token
- ✅ subscription_type (应该是 "Free")
- ✅ trial_days (应该是 7)
- ✅ expire_time (应该是注册时间 + 7 天)
- ✅ quota_remaining (应该接近 100)
- ✅ quota_used (应该接近 0)
- ✅ quota_total (应该是 100)

#### 4.3 测试新账户登录
1. 找到刚注册的账户
2. 点击 "🚀 一键登录到 VS Code" 按钮
3. 验证登录是否成功

### 5. 测试编辑功能

#### 5.1 编辑账户信息
1. 点击账户卡片上的 "✏️" 按钮
2. 修改以下字段:
   - 密码
   - Token
   - 剩余额度
   - 总额度
   - 过期时间
3. 点击 "保存"
4. 验证修改是否生效

### 6. 测试删除功能

1. 点击账户卡片上的 "🗑️" 按钮
2. 确认删除对话框
3. 验证账户是否被删除

---

## 🐛 已知问题

### 问题 1: VS Code 未安装
**现象**: 点击登录按钮后,提示 "打开 VS Code 失败"
**解决方案**: 确保已安装 VS Code 并且 Verdent 插件已启用

### 问题 2: Token 过期
**现象**: 登录时提示 "获取授权码失败"
**解决方案**: 
1. 重新注册一个新账户
2. 或者手动更新账户的 Token

### 问题 3: 额度信息未显示
**现象**: 账户卡片中没有显示额度信息
**原因**: 旧账户数据可能缺少 `quota_remaining`、`quota_used`、`quota_total` 字段
**解决方案**: 
1. 删除旧账户
2. 重新注册新账户
3. 或者手动编辑账户,添加这些字段

---

## 📊 测试检查清单

### 显示功能
- [ ] 订阅类型显示正确
- [ ] 订阅类型颜色正确
- [ ] 试用天数显示正确
- [ ] 过期时间显示正确
- [ ] 过期时间颜色根据剩余天数变化
- [ ] 剩余天数提示显示正确
- [ ] 额度信息显示完整 (剩余/已用/总计)
- [ ] 额度进度条显示正确
- [ ] 额度百分比计算正确

### 登录功能
- [ ] 有效 Token 登录成功
- [ ] 无 Token 账户提示正确
- [ ] 过期账户显示确认对话框
- [ ] 无效 Token 显示错误提示
- [ ] 登录中显示加载状态
- [ ] 登录完成后 VS Code 自动打开
- [ ] VS Code 中 Verdent 插件登录成功

### 注册功能
- [ ] 注册流程实时日志输出
- [ ] 注册成功后账户数据完整
- [ ] 新账户包含所有必需字段
- [ ] 新账户可以正常登录

### 编辑功能
- [ ] 可以编辑账户信息
- [ ] 修改后数据保存成功
- [ ] 修改后显示更新

### 删除功能
- [ ] 删除前显示确认对话框
- [ ] 删除后账户消失

---

## 🎯 性能测试

### 测试 1: 批量注册
1. 注册 5 个账户 (并发数: 3)
2. 观察注册速度和成功率
3. 验证所有账户数据完整性

### 测试 2: 大量账户显示
1. 注册 10+ 个账户
2. 观察账户列表的渲染性能
3. 验证滚动流畅度

### 测试 3: 并发登录
1. 快速点击多个账户的登录按钮
2. 观察是否有冲突或错误
3. 验证每个登录请求都正确处理

---

## 📝 测试报告模板

```
测试日期: YYYY-MM-DD
测试人员: [姓名]
测试环境: Windows 10 / macOS / Linux

### 测试结果

#### 显示功能
- 订阅类型显示: ✅ / ❌
- 过期时间颜色: ✅ / ❌
- 额度信息显示: ✅ / ❌

#### 登录功能
- 正常登录: ✅ / ❌
- 错误处理: ✅ / ❌
- VS Code 打开: ✅ / ❌

#### 注册功能
- 注册成功率: X/Y
- 数据完整性: ✅ / ❌

### 发现的问题
1. [问题描述]
2. [问题描述]

### 建议
1. [改进建议]
2. [改进建议]
```

---

## 🎉 测试完成

如果所有测试项都通过,恭喜! 账户面板优化功能已经可以正常使用了! 🚀

