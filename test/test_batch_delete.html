<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‰¹é‡åˆ é™¤åŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            margin-bottom: 30px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
        }
        .test-title {
            font-weight: bold;
            color: #007aff;
            margin-bottom: 10px;
        }
        .code-block {
            background: #f8f8f8;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            overflow-x: auto;
        }
        .issue {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 10px;
            margin: 10px 0;
        }
        .solution {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 10px;
            margin: 10px 0;
        }
        .error {
            color: #dc3545;
            font-weight: bold;
        }
        .success {
            color: #28a745;
            font-weight: bold;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background: #f0f0f0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ æ‰¹é‡åˆ é™¤åŠŸèƒ½ä¿®å¤æŠ¥å‘Š</h1>
        
        <div class="test-section">
            <div class="test-title">é—®é¢˜æè¿°</div>
            <div class="issue">
                <p><span class="error">é—®é¢˜ï¼š</span>æ‰¹é‡åˆ é™¤è´¦æˆ·åŠŸèƒ½æ— æ•ˆï¼Œç‚¹å‡»åˆ é™¤åè´¦æˆ·ä»ç„¶å­˜åœ¨</p>
                <p><strong>ç—‡çŠ¶ï¼š</strong></p>
                <ul>
                    <li>é€‰ä¸­å¤šä¸ªè´¦æˆ·åç‚¹å‡»æ‰¹é‡åˆ é™¤</li>
                    <li>ç¡®è®¤åˆ é™¤åï¼Œç•Œé¢æ˜¾ç¤º"åˆ é™¤æˆåŠŸ"</li>
                    <li>ä½†è´¦æˆ·å®é™…å¹¶æœªè¢«åˆ é™¤</li>
                </ul>
            </div>
        </div>

        <div class="test-section">
            <div class="test-title">æ ¹æœ¬åŸå› åˆ†æ</div>
            <table>
                <tr>
                    <th>ç»„ä»¶</th>
                    <th>é—®é¢˜</th>
                    <th>å½±å“</th>
                </tr>
                <tr>
                    <td>å‰ç«¯ (Vue)</td>
                    <td>å‚æ•°åé”™è¯¯ï¼šä½¿ç”¨ <code>accountId</code></td>
                    <td>åç«¯æ— æ³•è¯†åˆ«å‚æ•°</td>
                </tr>
                <tr>
                    <td>åç«¯ (Rust)</td>
                    <td>æœŸæœ›å‚æ•°åï¼š<code>id</code></td>
                    <td>å‚æ•°ä¸åŒ¹é…å¯¼è‡´åˆ é™¤å¤±è´¥</td>
                </tr>
            </table>
        </div>

        <div class="test-section">
            <div class="test-title">é”™è¯¯ä»£ç å¯¹æ¯”</div>
            <p><strong>âŒ é”™è¯¯çš„ä»£ç ï¼ˆä¿®å¤å‰ï¼‰ï¼š</strong></p>
            <div class="code-block">
// AccountManager.vue - æ‰¹é‡åˆ é™¤å‡½æ•°
await invoke&lt;{ success: boolean; error?: string }&gt;('delete_account', {
    <span class="error">accountId: id</span>  // é”™è¯¯ï¼šå‚æ•°ååº”è¯¥æ˜¯ 'id'
})
            </div>
            
            <p><strong>âœ… æ­£ç¡®çš„ä»£ç ï¼ˆä¿®å¤åï¼‰ï¼š</strong></p>
            <div class="code-block">
// AccountManager.vue - æ‰¹é‡åˆ é™¤å‡½æ•°
await invoke('delete_account', {
    <span class="success">id: id</span>  // æ­£ç¡®ï¼šå‚æ•°åä¸åç«¯åŒ¹é…
})
            </div>
        </div>

        <div class="test-section">
            <div class="test-title">ä¿®å¤æ–¹æ¡ˆ</div>
            <div class="solution">
                <p><span class="success">è§£å†³æ–¹æ¡ˆï¼š</span>ä¿®æ”¹å‰ç«¯å‚æ•°åï¼Œä¸åç«¯ä¿æŒä¸€è‡´</p>
                <ol>
                    <li><strong>ä¿®æ”¹æ–‡ä»¶ï¼š</strong> <code>src/components/AccountManager.vue</code></li>
                    <li><strong>ä¿®æ”¹ä½ç½®ï¼š</strong> <code>handleBatchDelete</code> å‡½æ•°</li>
                    <li><strong>ä¿®æ”¹å†…å®¹ï¼š</strong>
                        <ul>
                            <li>å°† <code>accountId: id</code> æ”¹ä¸º <code>id: id</code></li>
                            <li>ç§»é™¤ä¸å¿…è¦çš„è¿”å›å€¼ç±»å‹å£°æ˜</li>
                            <li>æ·»åŠ é”™è¯¯æ—¥å¿—è¾“å‡º</li>
                        </ul>
                    </li>
                </ol>
            </div>
        </div>

        <div class="test-section">
            <div class="test-title">å®Œæ•´ä¿®å¤ä»£ç </div>
            <div class="code-block">
// æ‰¹é‡åˆ é™¤å‡½æ•° - å®Œæ•´ä¿®å¤ç‰ˆæœ¬
async function handleBatchDelete() {
  const ids = Array.from(selectedAccounts.value)
  if (ids.length === 0) {
    showToast('è¯·å…ˆé€‰æ‹©è¦åˆ é™¤çš„è´¦æˆ·', 'warning')
    return
  }

  showConfirm(
    `ç¡®å®šè¦åˆ é™¤ ${ids.length} ä¸ªè´¦æˆ·å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼`,
    async () => {
      loading.value = true
      let successCount = 0
      let failCount = 0

      try {
        for (const id of ids) {
          try {
            await invoke('delete_account', {
              <span class="success">id: id  // âœ… æ­£ç¡®çš„å‚æ•°å</span>
            })
            successCount++
          } catch (error) {
            <span class="success">console.error(`åˆ é™¤è´¦æˆ· ${id} å¤±è´¥:`, error)  // âœ… æ·»åŠ é”™è¯¯æ—¥å¿—</span>
            failCount++
          }
        }

        if (failCount === 0) {
          showToast(`æˆåŠŸåˆ é™¤ ${successCount} ä¸ªè´¦æˆ·`, 'success')
        } else {
          showToast(`åˆ é™¤å®Œæˆï¼šæˆåŠŸ ${successCount} ä¸ªï¼Œå¤±è´¥ ${failCount} ä¸ª`, 'warning')
        }
        
        await loadAccounts()
        selectedAccounts.value.clear()
      } finally {
        loading.value = false
      }
    },
    { title: 'æ‰¹é‡åˆ é™¤', confirmText: 'åˆ é™¤', type: 'error' }
  )
}
            </div>
        </div>

        <div class="test-section">
            <div class="test-title">æµ‹è¯•éªŒè¯</div>
            <table>
                <tr>
                    <th>æµ‹è¯•åœºæ™¯</th>
                    <th>é¢„æœŸç»“æœ</th>
                    <th>çŠ¶æ€</th>
                </tr>
                <tr>
                    <td>å•ä¸ªè´¦æˆ·åˆ é™¤</td>
                    <td>è´¦æˆ·è¢«æˆåŠŸåˆ é™¤</td>
                    <td><span class="success">âœ… æ­£å¸¸</span></td>
                </tr>
                <tr>
                    <td>æ‰¹é‡åˆ é™¤å¤šä¸ªè´¦æˆ·</td>
                    <td>æ‰€é€‰è´¦æˆ·å…¨éƒ¨åˆ é™¤</td>
                    <td><span class="success">âœ… å·²ä¿®å¤</span></td>
                </tr>
                <tr>
                    <td>åˆ é™¤å¤±è´¥æ—¶çš„é”™è¯¯å¤„ç†</td>
                    <td>æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯å’Œå¤±è´¥æ•°é‡</td>
                    <td><span class="success">âœ… å·²æ”¹è¿›</span></td>
                </tr>
            </table>
        </div>

        <div class="test-section">
            <div class="test-title">ç›¸å…³æ–‡ä»¶</div>
            <ul>
                <li><code>src/components/AccountManager.vue</code> - å‰ç«¯æ‰¹é‡åˆ é™¤é€»è¾‘</li>
                <li><code>src-tauri/src/commands.rs</code> - åç«¯åˆ é™¤å‘½ä»¤</li>
                <li><code>src-tauri/src/account_manager.rs</code> - è´¦æˆ·ç®¡ç†å™¨åˆ é™¤å®ç°</li>
            </ul>
        </div>

        <div class="test-section">
            <div class="test-title">æ€»ç»“</div>
            <div class="solution">
                <p><strong>ä¿®å¤çŠ¶æ€ï¼š</strong> <span class="success">âœ… å·²å®Œæˆ</span></p>
                <p><strong>ä¿®å¤å†…å®¹ï¼š</strong></p>
                <ul>
                    <li>âœ… ä¿®æ­£å‰ç«¯è°ƒç”¨å‚æ•°åä» <code>accountId</code> åˆ° <code>id</code></li>
                    <li>âœ… æ·»åŠ è¯¦ç»†çš„é”™è¯¯æ—¥å¿—è¾“å‡º</li>
                    <li>âœ… ç®€åŒ–è¿”å›å€¼å¤„ç†é€»è¾‘</li>
                    <li>âœ… ä¿æŒä¸å•ä¸ªåˆ é™¤åŠŸèƒ½çš„ä¸€è‡´æ€§</li>
                </ul>
                <p><strong>å½±å“èŒƒå›´ï¼š</strong> ä»…å½±å“æ‰¹é‡åˆ é™¤åŠŸèƒ½ï¼Œä¸å½±å“å…¶ä»–åŠŸèƒ½</p>
            </div>
        </div>
    </div>
</body>
</html>
