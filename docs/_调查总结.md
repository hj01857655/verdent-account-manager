# VS Code state.vscdb è°ƒæŸ¥æ€»ç»“  
  
## è°ƒæŸ¥èŒƒå›´  
  
æœ¬æ¬¡è°ƒæŸ¥æ·±å…¥ç ”ç©¶äº†VS Codeçš„state.vscdbæ•°æ®åº“å­˜å‚¨æœºåˆ¶,ç‰¹åˆ«å…³æ³¨SecretStorage APIçš„å®é™…å®ç°ã€‚  
  
## æ ¸å¿ƒå‘ç°  
  
### 1. å­˜å‚¨ä½ç½®  
  
- **GlobalStorageæ•°æ®åº“**: `%C:\Users\Administrator\AppData\Roaming%\Code\User\globalStorage\state.vscdb` (266KB)  
- **WorkspaceStorageæ•°æ®åº“**: `%C:\Users\Administrator\AppData\Roaming%\Code\User\workspaceStorage\<hash>\state.vscdb` (77KB)  
- **Verdentæ‰©å±•æ–‡ä»¶**: `%C:\Users\Administrator\AppData\Roaming%\Code\User\globalStorage\verdentai.verdent\`  
  
### 2. SecretStorageå®ç°  
  
**å…³é”®å‘ç°**: SecretStorageå¹¶éç‹¬ç«‹å­˜å‚¨,è€Œæ˜¯state.vscdbä¸­çš„ç‰¹æ®Šè®°å½•!  
  
- **Keyæ ¼å¼**: `secret://{\"extensionId\":\"xxx\",\"key\":\"yyy\"}`  
- **Valueæ ¼å¼**: `{\"type\":\"Buffer\",\"data\":[å­—èŠ‚æ•°ç»„]}`  
- **åŠ å¯†ç‰ˆæœ¬**: v10  
- **åŠ å¯†æ–¹å¼**: Windows DPAPI / macOS Keychain / Linux libsecret  
  
### 3. æ•°æ®åº“ç»“æ„  
  
```sql  
-- ä¸»è¡¨  
ItemTable  
  - key: TEXT   
  - value: BLOB   
  
-- è¾…åŠ©è¡¨  
cursorDiskKV  
  - key: TEXT  
  - value: BLOB  
```  
  
### 4. Verdentæ‰©å±•çš„å®é™…å­˜å‚¨  
  
#### GlobalStorage  
1. `VerdentAI.verdent` - æ™®é€šçŠ¶æ€æ•°æ®  
2. `secret://{\"extensionId\":\"verdentai.verdent\",\"key\":\"verdent_ycAuthToken\"}` - **åŠ å¯†çš„è®¤è¯ä»¤ç‰Œ**  
3. `workbench.view.extension.verdent-ActivityBar.state.hidden` - UIçŠ¶æ€  
  
#### WorkspaceStorage  
1. `VerdentAI.verdent` - å·¥ä½œåŒºçŠ¶æ€  
2. `memento/webviewView.verdent.SidebarProvider` - ä¾§è¾¹æ çŠ¶æ€  
3. `workbench.view.extension.verdent-ActivityBar.*` - æ´»åŠ¨æ çŠ¶æ€  
  
#### æ–‡ä»¶å­˜å‚¨  
- `globalStorage\verdentai.verdent\settings\subagent_settings.json`  
- `globalStorage\verdentai.verdent\checkpoints\`  
- `globalStorage\verdentai.verdent\tasks\`  
  
### 5. åŠ å¯†æ•°æ®åˆ†æ  
  
Verdentçš„ycAuthTokenåŠ å¯†æ•°æ®:  
  
```  
æ€»é•¿åº¦: 266 bytes  
å‰ç¼€: v10 (ASCII)  
åŠ å¯†æ•°æ®: 263 bytes  
åå…­è¿›åˆ¶: 763130e335b1b4ea873b640c59c5c623f57e952e...  
```  
  
**ç‰¹å¾**:  
- æ— æ³•UTF-8è§£ç   
- ä½¿ç”¨DPAPIåŠ å¯†,åªèƒ½åœ¨å½“å‰ç”¨æˆ·/æœºå™¨è§£å¯†  
- ä¸èƒ½è·¨æœºå™¨è¿ç§»  
  
### 6. å…¶ä»–æ‰©å±•çš„Secretä½¿ç”¨æƒ…å†µ  
  
å‘ç°6ä¸ªåŠ å¯†secret:  
  
1. `alibaba-cloud.tongyi-lingma` - cosyAuthSecret  
2. `alibaba-cloud.tongyi-lingma` - secret.local.machine.variables  
3. `augment.vscode-augment` - augment.sessions  
4. `verdentai.verdent` - verdent_ycAuthToken  
5. `vscode.github-authentication` - github.auth  
6. `vscode.microsoft-authentication` - publicClients-AzureCloud  
  
## æŠ€æœ¯ç»†èŠ‚  
  
### globalState vs SecretStorage  
  
| ç‰¹æ€§ | globalState | SecretStorage |  
|---|---|---|  
| å­˜å‚¨ä½ç½® | ItemTable | ItemTable |  
| Keyæ ¼å¼ | æ™®é€šå­—ç¬¦ä¸² | `secret://...` |  
| åŠ å¯† | å¦ | æ˜¯(OSçº§) |  
| ç”¨é€” | é…ç½®ã€çŠ¶æ€ | ä»¤ç‰Œã€å¯†ç  |  
| å¯è¿ç§» | æ˜¯ | å¦ |  
  
### storage.json vs state.vscdb  
  
| ç‰¹æ€§ | storage.json | state.vscdb |  
|---|---|---|  
| æ ¼å¼ | çº¯JSON | SQLite |  
| å¤§å° | 7KB | 266KB |  
| å†…å®¹ | çª—å£çŠ¶æ€ã€ä¸»é¢˜ | æ‰©å±•çŠ¶æ€ã€Secrets |  
| å¯è¯»æ€§ | é«˜ | éœ€å·¥å…· |  
  
## å®é™…è·¯å¾„æ˜ å°„  
  
```  
C:\Users\Administrator\AppData\Roaming\Code\  
â”‚  
â”œâ”€â”€ User\  
â”‚   â”œâ”€â”€ globalStorage\  
â”‚   â”‚   â”œâ”€â”€ state.vscdb                    <-- ä¸»æ•°æ®åº“,185æ¡è®°å½•,6ä¸ªsecrets  
â”‚   â”‚   â”œâ”€â”€ state.vscdb.backup             <-- å¤‡ä»½  
â”‚   â”‚   â”œâ”€â”€ storage.json                   <-- JSONçŠ¶æ€  
â”‚   â”‚   â””â”€â”€ verdentai.verdent\             <-- Verdentæ‰©å±•æ–‡ä»¶  
â”‚   â”‚       â”œâ”€â”€ settings\subagent_settings.json  
â”‚   â”‚       â”œâ”€â”€ checkpoints\               <-- 3ä¸ªcheckpointç›®å½•  
â”‚   â”‚       â””â”€â”€ tasks\                     <-- 4ä¸ªtaskç›®å½•  
â”‚   â”‚  
â”‚   â””â”€â”€ workspaceStorage\  
â”‚       â””â”€â”€ 7476a1a055604ef7636d79ce08179d1f\  
â”‚           â”œâ”€â”€ state.vscdb                <-- å·¥ä½œåŒºæ•°æ®åº“  
â”‚           â”œâ”€â”€ workspace.json            <-- å·¥ä½œåŒºé…ç½®  
â”‚           â”œâ”€â”€ Augment.vscode-augment\  
â”‚           â””â”€â”€ ms-python.python\  
```  
  
## è°ƒæŸ¥æ–¹æ³•  
  
1. **æ–‡ä»¶ç³»ç»Ÿåˆ†æ**: å®šä½å®é™…å­˜å‚¨è·¯å¾„  
2. **SQLiteæ•°æ®åº“æ£€æŸ¥**: Python + sqlite3æ¨¡å—  
3. **æ•°æ®ç»“æ„åˆ†æ**: è¡¨ç»“æ„ã€Key-Valueæ ¼å¼  
4. **åŠ å¯†æ•°æ®åˆ†æ**: åå…­è¿›åˆ¶dumpã€ç‰ˆæœ¬è¯†åˆ«  
5. **ä»£ç æœç´¢**: é¡¹ç›®ä¸­ç›¸å…³å®ç°  
  
## ç”Ÿæˆçš„æ–‡æ¡£  
  
1. **VS_Code_state_vscdb_è°ƒæŸ¥æŠ¥å‘Š.md** - å®Œæ•´è¯¦ç»†æŠ¥å‘Š  
2. **SecretStorage_åŠ å¯†æœºåˆ¶.md** - åŠ å¯†æœºåˆ¶ä¸“é¢˜  
3. **_è°ƒæŸ¥æ€»ç»“.md** (æœ¬æ–‡ä»¶) - æ ¸å¿ƒå‘ç°æ‘˜è¦  
  
## ç»“è®º  
  
1. âœ… **ç¡®è®¤**: VS Code SecretStorageä½¿ç”¨state.vscdbçš„ItemTableå­˜å‚¨åŠ å¯†æ•°æ®  
2. âœ… **ç¡®è®¤**: Verdentæ‰©å±•æ­£ç¡®ä½¿ç”¨SecretStorage APIå­˜å‚¨ycAuthToken  
3. âœ… **ç¡®è®¤**: åŠ å¯†ä½¿ç”¨Windows DPAPI,å®‰å…¨æ€§é«˜ä½†æ— æ³•è¿ç§»  
4. âœ… **ç¡®è®¤**: Keyä½¿ç”¨ç‰¹æ®Šçš„`secret://`URIæ ¼å¼  
5. âœ… **ç¡®è®¤**: åŠ å¯†ç‰ˆæœ¬ä¸ºv10,æ•°æ®ä¸ºBufferå­—èŠ‚æ•°ç»„  
  
## å®é™…åº”ç”¨å»ºè®®  
  
### å¯¹äºVerdentå¼€å‘  
- âœ… å½“å‰ä½¿ç”¨SecretStorageå­˜å‚¨tokenæ˜¯æ­£ç¡®çš„  
- âš ï¸ ç”¨æˆ·æ¢æœºå™¨åéœ€è¦é‡æ–°ç™»å½•(åŠ å¯†æ•°æ®æ— æ³•è¿ç§»)  
- ğŸ’¡ å¯è€ƒè™‘æä¾›"å¯¼å‡ºé…ç½®"åŠŸèƒ½(ä¸åŒ…å«åŠ å¯†token)  
  
### å¯¹äºå¤šè´¦å·ç®¡ç†å·¥å…·  
- âŒ æ— æ³•ç›´æ¥è¯»å–/ä¿®æ”¹state.vscdbä¸­çš„åŠ å¯†secret  
- âœ… å¯ä»¥è¯»å–/ä¿®æ”¹storage.jsonä¸­çš„éåŠ å¯†æ•°æ®  
- âœ… å¯ä»¥ç®¡ç†globalStorage\verdentai.verdent\ä¸­çš„æ–‡ä»¶  
- ğŸ’¡ éœ€è¦é€šè¿‡VS Codeæ‰©å±•APIé—´æ¥æ“ä½œSecretStorage  
  
--- 
  
**è°ƒæŸ¥æ—¶é—´**: 2025-11-15  
**è°ƒæŸ¥å·¥å…·**: Python + sqlite3, Windowså‘½ä»¤è¡Œ  
**æ•°æ®åº“ç‰ˆæœ¬**: SQLite 3.x  
**VS Codeç‰ˆæœ¬**: åŸºäºå®é™…å®‰è£…ç‰ˆæœ¬  
